
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation site for FEBioChem">
      
      
        <meta name="author" content="Steve Maas">
      
      
      
        <link rel="prev" href="../febiochem_user_manual/">
      
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Theory - FEBioChem</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="FEBioChem" class="md-header__button md-logo" aria-label="FEBioChem" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            FEBioChem
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Theory
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../febiochem_tutorial1/" class="md-tabs__link">
          
  
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../febiochem_user_manual/" class="md-tabs__link">
        
  
  
    
  
  User Manual

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  Theory

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="FEBioChem" class="md-nav__button md-logo" aria-label="FEBioChem" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    FEBioChem
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../febiochem_tutorial1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tutorial 1
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../febiochem_user_manual/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    User Manual
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Theory
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Theory
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#weak-formulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Weak Formulation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#discretization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Discretization
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#time-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Time Integration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Time Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#backward-euler" class="md-nav__link">
    <span class="md-ellipsis">
      
        Backward Euler
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generalized-trapezoidal-rule" class="md-nav__link">
    <span class="md-ellipsis">
      
        Generalized Trapezoidal Rule
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chemical-reactions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chemical Reactions
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mixtures" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mixtures
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mixtures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solid-bound-molecules" class="md-nav__link">
    <span class="md-ellipsis">
      
        Solid-bound Molecules
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Theory</h1>

<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>Consider <span class="arithmatex">\(N\)</span> chemical species that undergo diffusion and can react with each other, and are inside a flow that moves with velocity <span class="arithmatex">\(\mathbf{v}\)</span>. The governing equation takes on the following form.</p>
<div class="arithmatex">\[
\begin{equation}
\label{eq:strong-form}
{{\partial }_{t}}{{u}^{\left( i \right)}}=\nabla \cdot \left( {{\mathbf{D}}^{\left( i \right)}}\nabla {{u}^{\left( i \right)}} \right)-\nabla \cdot \left( \mathbf{v}{{u}^{\left( i \right)}} \right)+{{R}^{\left( i \right)}}\left( \mathbf{u} \right),i=1\ldots N
\end{equation}
\]</div>
<p>Here, <span class="arithmatex">\({{u}^{\left( i \right)}}\)</span> represents the concentration of chemical species i, <span class="arithmatex">\({{\mathbf{D}}^{\left( i \right)}}\)</span> the diffusion tensor of species <span class="arithmatex">\(i\)</span>, and <span class="arithmatex">\({{R}^{\left( i \right)}}\)</span> accounts for all local reactions that contribute to the concentration of species <span class="arithmatex">\(i\)</span>. The vector <span class="arithmatex">\({{\mathbf{u}}^{T}}=\left[ {{u}^{\left( 1 \right)}},...,{{u}^{\left( N \right)}} \right]\)</span> represents all the concentrations.</p>
<h2 id="weak-formulation">Weak Formulation<a class="headerlink" href="#weak-formulation" title="Permanent link">&para;</a></h2>
<p>First, an integral version of this equation must be established. Let’s reorganize the terms as follows,</p>
<div class="arithmatex">\[
-{{\partial }_{t}}{{u}^{\left( i \right)}}-\nabla \cdot \left( \mathbf{v}{{u}^{\left( i \right)}} \right)+\nabla \cdot \left( {{\mathbf{D}}^{\left( i \right)}}\nabla {{u}^{\left( i \right)}} \right)+{{R}^{\left( i \right)}}\left( \mathbf{u} \right)=0
\]</div>
<p>Then, consider <span class="arithmatex">\(w\)</span> a trial function and integrate over the domain.</p>
<div class="arithmatex">\[\sum\limits_{i=1}^{N}{\int\limits_{V}{{{w}^{\left( i \right)}}\left[ -{{\partial }_{t}}{{u}^{\left( i \right)}}-\nabla \cdot \left( \mathbf{v}{{u}^{\left( i \right)}} \right)+\nabla \cdot \left( {{\mathbf{D}}^{\left( i \right)}}\nabla {{u}^{\left( i \right)}} \right)+{{R}^{\left( i \right)}}\left( \mathbf{u} \right) \right]dV}}=0\]</div>
<p>This can be rewritten as,</p>
<div class="arithmatex">\[\begin{align}
  &amp; -\sum\limits_{i=1}^{N}{\int\limits_{V}{{{w}^{\left( i \right)}}{{\partial }_{t}}{{u}^{\left( i \right)}}dV}}-\sum\limits_{i=1}^{N}{\int\limits_{V}{{{w}^{\left( i \right)}}\nabla \cdot \left( \mathbf{v}{{u}^{\left( i \right)}} \right)}}+\sum\limits_{i=1}^{N}{\int\limits_{S}{{{w}^{\left( i \right)}}{{\mathbf{q}}^{\left( i \right)}}\cdot \mathbf{n}dS}} \\ 
 &amp; -\sum\limits_{i=1}^{N}{\int\limits_{V}{\nabla {{w}^{\left( i \right)}}\cdot {{\mathbf{D}}^{\left( i \right)}}\nabla {{u}^{\left( i \right)}}dV}}+\sum\limits_{i=1}^{N}{\int\limits_{V}{{{w}^{\left( i \right)}}{{R}^{\left( i \right)}}dV}}=0 \\ 
\end{align}\]</div>
<p>Here, <span class="arithmatex">\(\mathbf{q}=-\mathbf{D}\nabla u\)</span>, is the flux vector and the second term is integrated over the surface for which <span class="arithmatex">\(\mathbf{q}\)</span> is prescribed.</p>
<h2 id="discretization">Discretization<a class="headerlink" href="#discretization" title="Permanent link">&para;</a></h2>
<p>Next, the finite element approximations are introduced.</p>
<div class="arithmatex">\[{{u}^{\left( i \right)}}=\sum\limits_{a}{{{N}_{a}}u_{a}^{\left( i \right)},{{w}^{\left( i \right)}}=\sum\limits_{a}{{{N}_{a}}w_{a}^{\left( i \right)}},{{{\dot{u}}}^{\left( i \right)}}=\sum\limits_{a}{{{N}_{a}}\dot{u}_{a}^{\left( i \right)}}}\]</div>
<p>This results in the following,</p>
<div class="arithmatex">\[\begin{align}
  &amp; -\sum\limits_{i=1}^{N}{\sum\limits_{b}{\dot{u}_{b}^{\left( i \right)}\left( \int\limits_{V}{{{N}_{a}}{{N}_{b}}dV} \right)}}-\sum\limits_{i=1}^{N}{\sum\limits_{b}^{{}}{u_{b}^{\left( i \right)}\left( \int\limits_{V}{{{N}_{a}}\nabla \cdot \left( \mathbf{v}{{N}_{b}} \right)}dV \right)}}+\sum\limits_{i=1}^{N}{\int\limits_{S}{{{N}_{a}}{{\mathbf{q}}^{\left( i \right)}}\cdot \mathbf{n}dS}} \\ 
 &amp; -\sum\limits_{i=1}^{N}{\sum\limits_{b}{u_{b}^{\left( i \right)}\left( \int\limits_{V}{\nabla {{N}_{a}}\cdot {{\mathbf{D}}^{\left( i \right)}}\nabla {{N}_{b}}dV} \right)}}+\sum\limits_{i=1}^{N}{\int\limits_{V}{{{N}_{a}}{{R}^{\left( i \right)}}dV}}=0 \\ 
\end{align}\]</div>
<p>This can be written as a matrix equation,</p>
<div class="arithmatex">\[
\begin{equation}
\label{eq:semi-discrete}
\mathbf{M\dot{U}}+\mathbf{DU}=\mathbf{F}\left( \mathbf{U} \right)
\end{equation}
\]</div>
<div class="arithmatex">\[\begin{align}
  &amp; {{M}_{pq}}=\int\limits_{V}{{{N}_{a}}{{N}_{b}}dV} \\ 
 &amp; {{D}_{pq}}=\int\limits_{V}{\nabla {{N}_{a}}\cdot {{\mathbf{D}}^{\left( i \right)}}\nabla {{N}_{b}}dV}+\int\limits_{V}{{{N}_{a}}\nabla \cdot \left( \mathbf{v}{{N}_{b}} \right)dV} \\ 
 &amp; {{F}_{p}}=\sum\limits_{i=1}^{N}{\int\limits_{S}{{{N}_{a}}{{\mathbf{q}}^{\left( i \right)}}\cdot \mathbf{n}dS}}+\int\limits_{V}{{{N}_{a}}{{R}^{\left( i \right)}}dV} \\ 
\end{align}\]</div>
<p>Here, degrees of freedom are denoted by <span class="arithmatex">\(p\)</span>, where <span class="arithmatex">\(p\)</span> is the degree of freedom <span class="arithmatex">\(i\)</span> of node <span class="arithmatex">\(a\)</span>. Similarly, <span class="arithmatex">\(q\)</span> refers to the degree of freedom <span class="arithmatex">\(j\)</span> of node <span class="arithmatex">\(b\)</span>.</p>
<p>Equation (\ref{eq:semi-discrete}) is the semi-discrete equation. Next, a time integration method needs to be introduced. Using the generalized trapezoidal rule this can be written as,</p>
<div class="arithmatex">\[\left( \mathbf{M}+\alpha \Delta t\mathbf{D} \right){{\mathbf{U}}_{n+1}}=\left( \mathbf{M}-\left( 1-\alpha  \right)\Delta t\mathbf{D} \right){{\mathbf{U}}_{n}}+\Delta t\left( \alpha {{\mathbf{F}}_{n+1}}+\left( 1-\alpha  \right){{\mathbf{F}}_{n}} \right)\]</div>
<p>which is a nonlinear system of equations.</p>
<h2 id="time-integration">Time Integration<a class="headerlink" href="#time-integration" title="Permanent link">&para;</a></h2>
<h3 id="backward-euler">Backward Euler<a class="headerlink" href="#backward-euler" title="Permanent link">&para;</a></h3>
<p>For <span class="arithmatex">\(\alpha=1\)</span> , we recover the backward Euler method.</p>
<div class="arithmatex">\[\left( \mathbf{M}+\Delta t\mathbf{D} \right){{\mathbf{U}}_{n+1}}=\mathbf{M}{{\mathbf{U}}_{n}}+\Delta t\mathbf{F}\left( {{\mathbf{U}}_{n+1}} \right)\]</div>
<p>We solve it using Newton’s method. First, we define the residual.</p>
<div class="arithmatex">\[\begin{align}
  &amp; \mathbf{R}\left( {{\mathbf{U}}_{n+1}} \right)=\mathbf{\tilde{K}}{{\mathbf{U}}_{n+1}}-\Delta t\mathbf{F}\left( {{\mathbf{U}}_{n+1}} \right)-\mathbf{M}{{\mathbf{U}}_{n}} \\ 
 &amp; =\mathbf{M}\left( {{\mathbf{U}}_{n+1}}-{{\mathbf{U}}_{n}} \right)+\Delta t\mathbf{D}{{\mathbf{U}}_{n+1}}-\Delta t\mathbf{F}\left( {{\mathbf{U}}_{n+1}} \right)  
\end{align}\]</div>
<p>where <span class="arithmatex">\(\mathbf{\tilde{K}}=\mathbf{M}+\Delta t\mathbf{D}\)</span>. A Taylor expansion around the current guess gives,</p>
<div class="arithmatex">\[\mathbf{R}\left( \mathbf{U}_{n+1}^{k}+\Delta \mathbf{U} \right)=\mathbf{R}\left( \mathbf{U}_{n+1}^{k} \right)+\mathbf{K}\left( \mathbf{U}_{n+1}^{k} \right)\Delta \mathbf{U}=\mathbf{0}\]</div>
<p>Here,</p>
<div class="arithmatex">\[\begin{align}
  &amp; \mathbf{K}=\frac{d\mathbf{R}}{d\mathbf{U}}=\mathbf{\tilde{K}}-\Delta t\frac{d\mathbf{F}}{d\mathbf{U}} \\ 
 &amp; =\mathbf{M}+\Delta t\left( \mathbf{D}-\frac{d\mathbf{F}}{d\mathbf{U}} \right)  
\end{align}\]</div>
<p>This can be solved for <span class="arithmatex">\(\Delta \mathbf{U}\)</span>.</p>
<div class="arithmatex">\[\mathbf{K}\,\Delta \mathbf{U}=-\mathbf{R}\]</div>
<p>Then, the solution can be updated,</p>
<div class="arithmatex">\[\mathbf{U}_{n+1}^{k+1}=\mathbf{U}_{n+1}^{k}+\Delta \mathbf{U}\]</div>
<h3 id="generalized-trapezoidal-rule">Generalized Trapezoidal Rule<a class="headerlink" href="#generalized-trapezoidal-rule" title="Permanent link">&para;</a></h3>
<p>Considering the general case,</p>
<div class="arithmatex">\[\left( \mathbf{M}+\alpha \Delta t\mathbf{D} \right){{\mathbf{U}}_{n+1}}=\left( \mathbf{M}-\left( 1-\alpha  \right)\Delta t\mathbf{D} \right){{\mathbf{U}}_{n}}+\Delta t\left( \alpha \mathbf{F}\left( {{\mathbf{U}}_{n+1}} \right)+\left( 1-\alpha  \right)\mathbf{F}\left( {{\mathbf{U}}_{n}} \right) \right)\]</div>
<p>The residual in this case can be written as,</p>
<div class="arithmatex">\[\mathbf{R}\left( {{\mathbf{U}}_{n+1}} \right)=\mathbf{M}\left( {{\mathbf{U}}_{n+1}}-{{\mathbf{U}}_{n}} \right)+\Delta t\mathbf{D}\left( \alpha {{\mathbf{U}}_{n+1}}+\left( 1-\alpha  \right){{\mathbf{U}}_{n}} \right)-\Delta t\left( \alpha {{\mathbf{F}}_{n+1}}+\left( 1-\alpha  \right){{\mathbf{F}}_{n}} \right)\]</div>
<p>It follows that the stiffness matrix is given by,</p>
<div class="arithmatex">\[\mathbf{K}=\mathbf{M}+\alpha \Delta t\left( \mathbf{D}-\frac{d\mathbf{F}}{d\mathbf{U}} \right)\]</div>
<h2 id="chemical-reactions">Chemical Reactions<a class="headerlink" href="#chemical-reactions" title="Permanent link">&para;</a></h2>
<p>Thus far, F remained unspecified, or better R. We look now at the specific form this function takes when considering chemical reactions.</p>
<p>A general chemical reaction is specified as,</p>
<div class="arithmatex">\[\sum\limits_{i}{{{{{v}'}}_{ij}}}{{M}_{i}}\overset{{{k}_{j}}}{\mathop{\to }}\,\sum\limits_{i}{{{{{v}''}}_{ij}}{{M}_{i}}}\]</div>
<p>Here, <span class="arithmatex">\({{M}_{i}}\)</span> denotes the chemical species.</p>
<p>For chemical reactions, <span class="arithmatex">\(R^{(i)}\)</span> takes on the following form,</p>
<div class="arithmatex">\[{{R}^{\left( i \right)}}=\sum\limits_{j=1}^{J}{{{v}_{ij}}{{r}_{j}}}\]</div>
<p>Here, the sum is over <span class="arithmatex">\(J\)</span> reactions and <span class="arithmatex">\({{v}_{ij}}={{{v}''}_{ij}}-{{{v}'}_{ij}}\)</span> and,</p>
<div class="arithmatex">\[{{r}_{j}}={{k}_{j}}\prod\limits_{i=1}^{I}{{{\left[ {{u}^{\left( i \right)}} \right]}^{{{\mu }_{ij}}}}}\]</div>
<p>the reaction rate of reaction <span class="arithmatex">\(j\)</span>. Usually, the exponent is taken to be <span class="arithmatex">\({{\mu }_{ij}}={{{\nu }'}_{ij}}\)</span>, as according to the law of mass action.</p>
<p>Let’s evaluate the stiffness matrix for <span class="arithmatex">\(\mathbf{F}\)</span>.</p>
<div class="arithmatex">\[{{k}_{pq}}=\int\limits_{{{V}^{e}}}{{{N}_{a}}\frac{d}{d{{u}_{q}}}{{R}^{\left( i \right)}}\left( \mathbf{u} \right)}dV\]</div>
<p>Evaluating the derivative of <span class="arithmatex">\(R\)</span> with respect to degree of freedom <span class="arithmatex">\(q\)</span>, we find,</p>
<div class="arithmatex">\[\frac{d{{R}^{\left( i \right)}}}{d{{u}_{q}}}={{N}_{b}}{{\gamma }_{ij}}\]</div>
<p>where,</p>
<div class="arithmatex">\[{{\gamma }_{ij}}=\sum\limits_{k=1}^{J}{{{v}_{ik}}\frac{d{{r}_{k}}}{d{{u}^{\left( j \right)}}}}\]</div>
<p>Thus, the element stiffness matrix is given by,</p>
<div class="arithmatex">\[{{k}_{pq}}=\int\limits_{{{V}^{e}}}{{{\gamma }_{ij}}{{N}_{a}}{{N}_{b}}}dV\]</div>
<h2 id="mixtures">Mixtures<a class="headerlink" href="#mixtures" title="Permanent link">&para;</a></h2>
<p>Thus far, we considered the case where the solute is free, i.e. not inside a porous material. In the case if the solutes are contained inside a porous material, then the equations above remain valid, except now that the concentrations are with respect to the mixture volume. The 'true' concentration <span class="arithmatex">\({{c}^{\left( i \right)}}\)</span>, i.e. the concentration w.r.t. to the solvent is related to the 'bulk' concentration via,</p>
<div class="arithmatex">\[{{u}^{\left( i \right)}}=\varphi {{c}^{\left( i \right)}}\]</div>
<p>where <span class="arithmatex">\(\varphi\)</span>  is the fluid volume fraction, i.e. the fraction of the volume that is accessible to the fluid (and therefore to the solvents).</p>
<p>In the absence of chemical reactions and convection, equation (\ref{eq:strong-form}) becomes,</p>
<div class="arithmatex">\[{{\partial }_{t}}\left( \varphi {{c}^{\left( i \right)}} \right)=\nabla \cdot \left( \varphi {{\mathbf{D}}^{\left( i \right)}}\nabla {{c}^{\left( i \right)}} \right),i=1\ldots N\]</div>
<p>Note that <span class="arithmatex">\(\varphi\)</span> can be dependent on the position, so in general does not drop out of the equation.</p>
<p>Note that now <span class="arithmatex">\(\mathbf{D}\)</span> is the diffusivity in the porous mixture and can be different (i.e. lower) than the free diffusivity.</p>
<p>Performing the usual steps,</p>
<div class="arithmatex">\[-\sum\limits_{i}{\int\limits_{V}{{{w}^{\left( i \right)}}{{\partial }_{t}}\left( \varphi {{u}^{\left( i \right)}} \right)dV}}-\sum\limits_{i}{\int\limits_{V}{\nabla {{w}^{\left( i \right)}}\cdot \left( \varphi {{\mathbf{D}}^{\left( i \right)}}\nabla {{u}^{\left( i \right)}} \right)dV}}-\sum\limits_{i}{\int\limits_{S}{{{w}^{\left( i \right)}}\mathbf{q}_{0}^{\left( i \right)}dS}}=0\]</div>
<p>where <span class="arithmatex">\({{\mathbf{q}}^{\left( i \right)}}=-\varphi {{\mathbf{D}}^{\left( i \right)}}\cdot \nabla {{\mathbf{c}}^{\left( i \right)}}\)</span>.  Introducing discretization,</p>
<div class="arithmatex">\[-\sum\limits_{i}{\sum\limits_{b}{\dot{c}_{b}^{\left( i \right)}\int\limits_{{{V}^{e}}}{\varphi {{N}_{a}}{{N}_{b}}dV}}}-\sum\limits_{i}{\sum\limits_{b}{c_{b}^{\left( i \right)}\int\limits_{V}{\nabla {{N}_{a}}\cdot \varphi {{\mathbf{D}}^{\left( i \right)}}\nabla {{N}_{b}}dV}}}-\sum\limits_{i}{\int\limits_{S}{{{w}^{\left( i \right)}}\mathbf{q}_{0}^{\left( i \right)}dS}}=0\]</div>
<h3 id="solid-bound-molecules">Solid-bound Molecules<a class="headerlink" href="#solid-bound-molecules" title="Permanent link">&para;</a></h3>
<p>In the above we assumed that the domain was composed of a mixture, defined by two phases, a solid and a fluid phase. The fluid was assumed to be a solvent in which several species were dissolved. We emphasize again that the volume fractions of the dissolved solutions are negligible and thus that the solid and fluid volume fractions add up to unity.</p>
<div class="arithmatex">\[{{\varphi }^{s}}+{{\varphi }^{f}}=1\]</div>
<p>We now consider the case that a chemical species exists as part of the solid phase. Such a species is called a <em>solid-bound molecule</em> (or <em>sbm</em>). Since it is bound to the solid (immovable) phase, it is assumed that a solid-bound molecule does not undergo diffusion. Let us denote the apparent density of the sbm by <span class="arithmatex">\({{\rho }^{\sigma }}\)</span>. It then follows that the governing equation for a solid-bound molecule is given by,</p>
<div class="arithmatex">\[\frac{d{{\rho }^{\sigma }}}{dt}={{\hat{\rho }}^{\sigma }}\]</div>
<p>where <span class="arithmatex">\({{\hat{\rho }}^{\sigma }}\)</span> is the mass supply for the sbm. In this context, the mass supply will be calculated from the chemical reactions.</p>
<p>Time integration is done via the backward Euler method.</p>
<div class="arithmatex">\[\rho _{t+\Delta t}^{\sigma ,k+1}=\rho _{t}^{\sigma }+\Delta t\hat{\rho }_{t+\Delta t}^{\sigma ,k}\]</div>
<p>Alternatively, the trapezoidal rule could be used,</p>
<div class="arithmatex">\[\rho _{t+\Delta t}^{\sigma ,k+1}=\rho _{t}^{\sigma }+\frac{\Delta t}{2}\left( \hat{\rho }_{t+\Delta t}^{\sigma ,k}+\hat{\rho }_{t}^{\sigma } \right)\]</div>
<p>A change in the apparent density of an SBM has an effect of the solid volume fraction, which is now defined via,</p>
<div class="arithmatex">\[{{\varphi }^{s}}=\varphi _{0}^{s}+\sum\limits_{\sigma }{{{\varphi }^{\sigma }}}\]</div>
<p>where the volume fraction of the sbm is defined via,</p>
<div class="arithmatex">\[{{\varphi }^{\sigma }}=\frac{{{\rho }^{\sigma }}}{\rho _{T}^{\sigma }}\]</div>
<p>That is, it is the ratio of the apparent density over the true density of the sbm. The fluid volume fraction, or porosity, is then defined via <span class="arithmatex">\(\varphi =1-{{\varphi }^{s}}\)</span>.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.tabs", "navigation.top", "search.highlight", "search.suggest", "toc.integrate", "content.external.links", "content.code.annotate", "content.code.copy"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../js/mathjax_config.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>