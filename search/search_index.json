{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"FEBioChem","text":"<p>This is the documentation for FEBioChem, an FEBio plugin that allows users to solve reaction-diffusion and reaction-diffusion-convection problems in the context of a (non-deformable) mixture with multiple chemical species. The species can be solutes that flow with the solvent, or can be bound to the solid phase of the mixture. In this regard, this plugin offers similar capabilities as the FEBioMix module in FEBio (at least for non-deformable mixtures). However, since the mixture is assumed non-deformable, the calculations are optimized and the performance improved.</p> <p>Please see the Tutorial page for a practical guide on using the FEBio Chem plugin with FEBio Studio. </p> <p>The User Manual page describes the features of the plugin in the context of the FEBio Input file. </p> <p>For some background on the theory, please see the Theory page. </p>"},{"location":"febiochem_theory/","title":"Theory","text":""},{"location":"febiochem_theory/#introduction","title":"Introduction","text":"<p>Consider \\(N\\) chemical species that undergo diffusion and can react with each other, and are inside a flow that moves with velocity \\(\\mathbf{v}\\). The governing equation takes on the following form.</p> \\[ \\begin{equation} \\label{eq:strong-form} {{\\partial }_{t}}{{u}^{\\left( i \\right)}}=\\nabla \\cdot \\left( {{\\mathbf{D}}^{\\left( i \\right)}}\\nabla {{u}^{\\left( i \\right)}} \\right)-\\nabla \\cdot \\left( \\mathbf{v}{{u}^{\\left( i \\right)}} \\right)+{{R}^{\\left( i \\right)}}\\left( \\mathbf{u} \\right),i=1\\ldots N \\end{equation} \\] <p>Here, \\({{u}^{\\left( i \\right)}}\\) represents the concentration of chemical species i, \\({{\\mathbf{D}}^{\\left( i \\right)}}\\) the diffusion tensor of species \\(i\\), and \\({{R}^{\\left( i \\right)}}\\) accounts for all local reactions that contribute to the concentration of species \\(i\\). The vector \\({{\\mathbf{u}}^{T}}=\\left[ {{u}^{\\left( 1 \\right)}},...,{{u}^{\\left( N \\right)}} \\right]\\) represents all the concentrations.</p>"},{"location":"febiochem_theory/#weak-formulation","title":"Weak Formulation","text":"<p>First, an integral version of this equation must be established. Let\u2019s reorganize the terms as follows,</p> \\[ -{{\\partial }_{t}}{{u}^{\\left( i \\right)}}-\\nabla \\cdot \\left( \\mathbf{v}{{u}^{\\left( i \\right)}} \\right)+\\nabla \\cdot \\left( {{\\mathbf{D}}^{\\left( i \\right)}}\\nabla {{u}^{\\left( i \\right)}} \\right)+{{R}^{\\left( i \\right)}}\\left( \\mathbf{u} \\right)=0 \\] <p>Then, consider \\(w\\) a trial function and integrate over the domain.</p> \\[\\sum\\limits_{i=1}^{N}{\\int\\limits_{V}{{{w}^{\\left( i \\right)}}\\left[ -{{\\partial }_{t}}{{u}^{\\left( i \\right)}}-\\nabla \\cdot \\left( \\mathbf{v}{{u}^{\\left( i \\right)}} \\right)+\\nabla \\cdot \\left( {{\\mathbf{D}}^{\\left( i \\right)}}\\nabla {{u}^{\\left( i \\right)}} \\right)+{{R}^{\\left( i \\right)}}\\left( \\mathbf{u} \\right) \\right]dV}}=0\\] <p>This can be rewritten as,</p> \\[\\begin{align}   &amp; -\\sum\\limits_{i=1}^{N}{\\int\\limits_{V}{{{w}^{\\left( i \\right)}}{{\\partial }_{t}}{{u}^{\\left( i \\right)}}dV}}-\\sum\\limits_{i=1}^{N}{\\int\\limits_{V}{{{w}^{\\left( i \\right)}}\\nabla \\cdot \\left( \\mathbf{v}{{u}^{\\left( i \\right)}} \\right)}}+\\sum\\limits_{i=1}^{N}{\\int\\limits_{S}{{{w}^{\\left( i \\right)}}{{\\mathbf{q}}^{\\left( i \\right)}}\\cdot \\mathbf{n}dS}} \\\\   &amp; -\\sum\\limits_{i=1}^{N}{\\int\\limits_{V}{\\nabla {{w}^{\\left( i \\right)}}\\cdot {{\\mathbf{D}}^{\\left( i \\right)}}\\nabla {{u}^{\\left( i \\right)}}dV}}+\\sum\\limits_{i=1}^{N}{\\int\\limits_{V}{{{w}^{\\left( i \\right)}}{{R}^{\\left( i \\right)}}dV}}=0 \\\\  \\end{align}\\] <p>Here, \\(\\mathbf{q}=-\\mathbf{D}\\nabla u\\), is the flux vector and the second term is integrated over the surface for which \\(\\mathbf{q}\\) is prescribed.</p>"},{"location":"febiochem_theory/#discretization","title":"Discretization","text":"<p>Next, the finite element approximations are introduced.</p> \\[{{u}^{\\left( i \\right)}}=\\sum\\limits_{a}{{{N}_{a}}u_{a}^{\\left( i \\right)},{{w}^{\\left( i \\right)}}=\\sum\\limits_{a}{{{N}_{a}}w_{a}^{\\left( i \\right)}},{{{\\dot{u}}}^{\\left( i \\right)}}=\\sum\\limits_{a}{{{N}_{a}}\\dot{u}_{a}^{\\left( i \\right)}}}\\] <p>This results in the following,</p> \\[\\begin{align}   &amp; -\\sum\\limits_{i=1}^{N}{\\sum\\limits_{b}{\\dot{u}_{b}^{\\left( i \\right)}\\left( \\int\\limits_{V}{{{N}_{a}}{{N}_{b}}dV} \\right)}}-\\sum\\limits_{i=1}^{N}{\\sum\\limits_{b}^{{}}{u_{b}^{\\left( i \\right)}\\left( \\int\\limits_{V}{{{N}_{a}}\\nabla \\cdot \\left( \\mathbf{v}{{N}_{b}} \\right)}dV \\right)}}+\\sum\\limits_{i=1}^{N}{\\int\\limits_{S}{{{N}_{a}}{{\\mathbf{q}}^{\\left( i \\right)}}\\cdot \\mathbf{n}dS}} \\\\   &amp; -\\sum\\limits_{i=1}^{N}{\\sum\\limits_{b}{u_{b}^{\\left( i \\right)}\\left( \\int\\limits_{V}{\\nabla {{N}_{a}}\\cdot {{\\mathbf{D}}^{\\left( i \\right)}}\\nabla {{N}_{b}}dV} \\right)}}+\\sum\\limits_{i=1}^{N}{\\int\\limits_{V}{{{N}_{a}}{{R}^{\\left( i \\right)}}dV}}=0 \\\\  \\end{align}\\] <p>This can be written as a matrix equation,</p> \\[ \\begin{equation} \\label{eq:semi-discrete} \\mathbf{M\\dot{U}}+\\mathbf{DU}=\\mathbf{F}\\left( \\mathbf{U} \\right) \\end{equation} \\] \\[\\begin{align}   &amp; {{M}_{pq}}=\\int\\limits_{V}{{{N}_{a}}{{N}_{b}}dV} \\\\   &amp; {{D}_{pq}}=\\int\\limits_{V}{\\nabla {{N}_{a}}\\cdot {{\\mathbf{D}}^{\\left( i \\right)}}\\nabla {{N}_{b}}dV}+\\int\\limits_{V}{{{N}_{a}}\\nabla \\cdot \\left( \\mathbf{v}{{N}_{b}} \\right)dV} \\\\   &amp; {{F}_{p}}=\\sum\\limits_{i=1}^{N}{\\int\\limits_{S}{{{N}_{a}}{{\\mathbf{q}}^{\\left( i \\right)}}\\cdot \\mathbf{n}dS}}+\\int\\limits_{V}{{{N}_{a}}{{R}^{\\left( i \\right)}}dV} \\\\  \\end{align}\\] <p>Here, degrees of freedom are denoted by \\(p\\), where \\(p\\) is the degree of freedom \\(i\\) of node \\(a\\). Similarly, \\(q\\) refers to the degree of freedom \\(j\\) of node \\(b\\).</p> <p>Equation (\\ref{eq:semi-discrete}) is the semi-discrete equation. Next, a time integration method needs to be introduced. Using the generalized trapezoidal rule this can be written as,</p> \\[\\left( \\mathbf{M}+\\alpha \\Delta t\\mathbf{D} \\right){{\\mathbf{U}}_{n+1}}=\\left( \\mathbf{M}-\\left( 1-\\alpha  \\right)\\Delta t\\mathbf{D} \\right){{\\mathbf{U}}_{n}}+\\Delta t\\left( \\alpha {{\\mathbf{F}}_{n+1}}+\\left( 1-\\alpha  \\right){{\\mathbf{F}}_{n}} \\right)\\] <p>which is a nonlinear system of equations.</p>"},{"location":"febiochem_theory/#time-integration","title":"Time Integration","text":""},{"location":"febiochem_theory/#backward-euler","title":"Backward Euler","text":"<p>For \\(\\alpha=1\\) , we recover the backward Euler method.</p> \\[\\left( \\mathbf{M}+\\Delta t\\mathbf{D} \\right){{\\mathbf{U}}_{n+1}}=\\mathbf{M}{{\\mathbf{U}}_{n}}+\\Delta t\\mathbf{F}\\left( {{\\mathbf{U}}_{n+1}} \\right)\\] <p>We solve it using Newton\u2019s method. First, we define the residual.</p> \\[\\begin{align}   &amp; \\mathbf{R}\\left( {{\\mathbf{U}}_{n+1}} \\right)=\\mathbf{\\tilde{K}}{{\\mathbf{U}}_{n+1}}-\\Delta t\\mathbf{F}\\left( {{\\mathbf{U}}_{n+1}} \\right)-\\mathbf{M}{{\\mathbf{U}}_{n}} \\\\   &amp; =\\mathbf{M}\\left( {{\\mathbf{U}}_{n+1}}-{{\\mathbf{U}}_{n}} \\right)+\\Delta t\\mathbf{D}{{\\mathbf{U}}_{n+1}}-\\Delta t\\mathbf{F}\\left( {{\\mathbf{U}}_{n+1}} \\right)   \\end{align}\\] <p>where \\(\\mathbf{\\tilde{K}}=\\mathbf{M}+\\Delta t\\mathbf{D}\\). A Taylor expansion around the current guess gives,</p> \\[\\mathbf{R}\\left( \\mathbf{U}_{n+1}^{k}+\\Delta \\mathbf{U} \\right)=\\mathbf{R}\\left( \\mathbf{U}_{n+1}^{k} \\right)+\\mathbf{K}\\left( \\mathbf{U}_{n+1}^{k} \\right)\\Delta \\mathbf{U}=\\mathbf{0}\\] <p>Here,</p> \\[\\begin{align}   &amp; \\mathbf{K}=\\frac{d\\mathbf{R}}{d\\mathbf{U}}=\\mathbf{\\tilde{K}}-\\Delta t\\frac{d\\mathbf{F}}{d\\mathbf{U}} \\\\   &amp; =\\mathbf{M}+\\Delta t\\left( \\mathbf{D}-\\frac{d\\mathbf{F}}{d\\mathbf{U}} \\right)   \\end{align}\\] <p>This can be solved for \\(\\Delta \\mathbf{U}\\).</p> \\[\\mathbf{K}\\,\\Delta \\mathbf{U}=-\\mathbf{R}\\] <p>Then, the solution can be updated,</p> \\[\\mathbf{U}_{n+1}^{k+1}=\\mathbf{U}_{n+1}^{k}+\\Delta \\mathbf{U}\\]"},{"location":"febiochem_theory/#generalized-trapezoidal-rule","title":"Generalized Trapezoidal Rule","text":"<p>Considering the general case,</p> \\[\\left( \\mathbf{M}+\\alpha \\Delta t\\mathbf{D} \\right){{\\mathbf{U}}_{n+1}}=\\left( \\mathbf{M}-\\left( 1-\\alpha  \\right)\\Delta t\\mathbf{D} \\right){{\\mathbf{U}}_{n}}+\\Delta t\\left( \\alpha \\mathbf{F}\\left( {{\\mathbf{U}}_{n+1}} \\right)+\\left( 1-\\alpha  \\right)\\mathbf{F}\\left( {{\\mathbf{U}}_{n}} \\right) \\right)\\] <p>The residual in this case can be written as,</p> \\[\\mathbf{R}\\left( {{\\mathbf{U}}_{n+1}} \\right)=\\mathbf{M}\\left( {{\\mathbf{U}}_{n+1}}-{{\\mathbf{U}}_{n}} \\right)+\\Delta t\\mathbf{D}\\left( \\alpha {{\\mathbf{U}}_{n+1}}+\\left( 1-\\alpha  \\right){{\\mathbf{U}}_{n}} \\right)-\\Delta t\\left( \\alpha {{\\mathbf{F}}_{n+1}}+\\left( 1-\\alpha  \\right){{\\mathbf{F}}_{n}} \\right)\\] <p>It follows that the stiffness matrix is given by,</p> \\[\\mathbf{K}=\\mathbf{M}+\\alpha \\Delta t\\left( \\mathbf{D}-\\frac{d\\mathbf{F}}{d\\mathbf{U}} \\right)\\]"},{"location":"febiochem_theory/#chemical-reactions","title":"Chemical Reactions","text":"<p>Thus far, F remained unspecified, or better R. We look now at the specific form this function takes when considering chemical reactions.</p> <p>A general chemical reaction is specified as,</p> \\[\\sum\\limits_{i}{{{{{v}'}}_{ij}}}{{M}_{i}}\\overset{{{k}_{j}}}{\\mathop{\\to }}\\,\\sum\\limits_{i}{{{{{v}''}}_{ij}}{{M}_{i}}}\\] <p>Here, \\({{M}_{i}}\\) denotes the chemical species.</p> <p>For chemical reactions, \\(R^{(i)}\\) takes on the following form,</p> \\[{{R}^{\\left( i \\right)}}=\\sum\\limits_{j=1}^{J}{{{v}_{ij}}{{r}_{j}}}\\] <p>Here, the sum is over \\(J\\) reactions and \\({{v}_{ij}}={{{v}''}_{ij}}-{{{v}'}_{ij}}\\) and,</p> \\[{{r}_{j}}={{k}_{j}}\\prod\\limits_{i=1}^{I}{{{\\left[ {{u}^{\\left( i \\right)}} \\right]}^{{{\\mu }_{ij}}}}}\\] <p>the reaction rate of reaction \\(j\\). Usually, the exponent is taken to be \\({{\\mu }_{ij}}={{{\\nu }'}_{ij}}\\), as according to the law of mass action.</p> <p>Let\u2019s evaluate the stiffness matrix for \\(\\mathbf{F}\\).</p> \\[{{k}_{pq}}=\\int\\limits_{{{V}^{e}}}{{{N}_{a}}\\frac{d}{d{{u}_{q}}}{{R}^{\\left( i \\right)}}\\left( \\mathbf{u} \\right)}dV\\] <p>Evaluating the derivative of \\(R\\) with respect to degree of freedom \\(q\\), we find,</p> \\[\\frac{d{{R}^{\\left( i \\right)}}}{d{{u}_{q}}}={{N}_{b}}{{\\gamma }_{ij}}\\] <p>where,</p> \\[{{\\gamma }_{ij}}=\\sum\\limits_{k=1}^{J}{{{v}_{ik}}\\frac{d{{r}_{k}}}{d{{u}^{\\left( j \\right)}}}}\\] <p>Thus, the element stiffness matrix is given by,</p> \\[{{k}_{pq}}=\\int\\limits_{{{V}^{e}}}{{{\\gamma }_{ij}}{{N}_{a}}{{N}_{b}}}dV\\]"},{"location":"febiochem_theory/#mixtures","title":"Mixtures","text":"<p>Thus far, we considered the case where the solute is free, i.e. not inside a porous material. In the case if the solutes are contained inside a porous material, then the equations above remain valid, except now that the concentrations are with respect to the mixture volume. The 'true' concentration \\({{c}^{\\left( i \\right)}}\\), i.e. the concentration w.r.t. to the solvent is related to the 'bulk' concentration via,</p> \\[{{u}^{\\left( i \\right)}}=\\varphi {{c}^{\\left( i \\right)}}\\] <p>where \\(\\varphi\\)  is the fluid volume fraction, i.e. the fraction of the volume that is accessible to the fluid (and therefore to the solvents).</p> <p>In the absence of chemical reactions and convection, equation (\\ref{eq:strong-form}) becomes,</p> \\[{{\\partial }_{t}}\\left( \\varphi {{c}^{\\left( i \\right)}} \\right)=\\nabla \\cdot \\left( \\varphi {{\\mathbf{D}}^{\\left( i \\right)}}\\nabla {{c}^{\\left( i \\right)}} \\right),i=1\\ldots N\\] <p>Note that \\(\\varphi\\) can be dependent on the position, so in general does not drop out of the equation.</p> <p>Note that now \\(\\mathbf{D}\\) is the diffusivity in the porous mixture and can be different (i.e. lower) than the free diffusivity.</p> <p>Performing the usual steps,</p> \\[-\\sum\\limits_{i}{\\int\\limits_{V}{{{w}^{\\left( i \\right)}}{{\\partial }_{t}}\\left( \\varphi {{u}^{\\left( i \\right)}} \\right)dV}}-\\sum\\limits_{i}{\\int\\limits_{V}{\\nabla {{w}^{\\left( i \\right)}}\\cdot \\left( \\varphi {{\\mathbf{D}}^{\\left( i \\right)}}\\nabla {{u}^{\\left( i \\right)}} \\right)dV}}-\\sum\\limits_{i}{\\int\\limits_{S}{{{w}^{\\left( i \\right)}}\\mathbf{q}_{0}^{\\left( i \\right)}dS}}=0\\] <p>where \\({{\\mathbf{q}}^{\\left( i \\right)}}=-\\varphi {{\\mathbf{D}}^{\\left( i \\right)}}\\cdot \\nabla {{\\mathbf{c}}^{\\left( i \\right)}}\\).  Introducing discretization,</p> \\[-\\sum\\limits_{i}{\\sum\\limits_{b}{\\dot{c}_{b}^{\\left( i \\right)}\\int\\limits_{{{V}^{e}}}{\\varphi {{N}_{a}}{{N}_{b}}dV}}}-\\sum\\limits_{i}{\\sum\\limits_{b}{c_{b}^{\\left( i \\right)}\\int\\limits_{V}{\\nabla {{N}_{a}}\\cdot \\varphi {{\\mathbf{D}}^{\\left( i \\right)}}\\nabla {{N}_{b}}dV}}}-\\sum\\limits_{i}{\\int\\limits_{S}{{{w}^{\\left( i \\right)}}\\mathbf{q}_{0}^{\\left( i \\right)}dS}}=0\\]"},{"location":"febiochem_theory/#solid-bound-molecules","title":"Solid-bound Molecules","text":"<p>In the above we assumed that the domain was composed of a mixture, defined by two phases, a solid and a fluid phase. The fluid was assumed to be a solvent in which several species were dissolved. We emphasize again that the volume fractions of the dissolved solutions are negligible and thus that the solid and fluid volume fractions add up to unity.</p> \\[{{\\varphi }^{s}}+{{\\varphi }^{f}}=1\\] <p>We now consider the case that a chemical species exists as part of the solid phase. Such a species is called a solid-bound molecule (or sbm). Since it is bound to the solid (immovable) phase, it is assumed that a solid-bound molecule does not undergo diffusion. Let us denote the apparent density of the sbm by \\({{\\rho }^{\\sigma }}\\). It then follows that the governing equation for a solid-bound molecule is given by,</p> \\[\\frac{d{{\\rho }^{\\sigma }}}{dt}={{\\hat{\\rho }}^{\\sigma }}\\] <p>where \\({{\\hat{\\rho }}^{\\sigma }}\\) is the mass supply for the sbm. In this context, the mass supply will be calculated from the chemical reactions.</p> <p>Time integration is done via the backward Euler method.</p> \\[\\rho _{t+\\Delta t}^{\\sigma ,k+1}=\\rho _{t}^{\\sigma }+\\Delta t\\hat{\\rho }_{t+\\Delta t}^{\\sigma ,k}\\] <p>Alternatively, the trapezoidal rule could be used,</p> \\[\\rho _{t+\\Delta t}^{\\sigma ,k+1}=\\rho _{t}^{\\sigma }+\\frac{\\Delta t}{2}\\left( \\hat{\\rho }_{t+\\Delta t}^{\\sigma ,k}+\\hat{\\rho }_{t}^{\\sigma } \\right)\\] <p>A change in the apparent density of an SBM has an effect of the solid volume fraction, which is now defined via,</p> \\[{{\\varphi }^{s}}=\\varphi _{0}^{s}+\\sum\\limits_{\\sigma }{{{\\varphi }^{\\sigma }}}\\] <p>where the volume fraction of the sbm is defined via,</p> \\[{{\\varphi }^{\\sigma }}=\\frac{{{\\rho }^{\\sigma }}}{\\rho _{T}^{\\sigma }}\\] <p>That is, it is the ratio of the apparent density over the true density of the sbm. The fluid volume fraction, or porosity, is then defined via \\(\\varphi =1-{{\\varphi }^{s}}\\).</p>"},{"location":"febiochem_tutorial1/","title":"Tutorial 1","text":"<p>In this first tutorial, we'll solve a simple 1D reaction-diffusion problem, where two species, \\(A\\) and \\(B\\), react via the equation. </p> \\[A \\to B\\] <p>The domain will consist of a block of size \\(10 \\times 1 \\times 1\\) block. On the left face of the block, a concentration flux of species A will be defined. Both species will be allowed to diffuse. </p>"},{"location":"febiochem_tutorial1/#prerequisites","title":"Prerequisites","text":"<p>We'll use the FEBioChem plugin in FEBio Studio. Before we can proceed, make sure that you have FEBio Studio (version 3.0 or above) installed on your computer. </p> <p>Next, you'll need to install the FEBioChem plugin. This can be done using the Plugin Repository in FEBio Studio. To open the Plugin Repository, use the menu FEBio \u2192  Plugin Repository.</p> <p></p> <p>Locate the FEBioChem plugin in the list on the left side and click the Download Plugin button.</p> <p>This will download and install the plugin.</p> <p>This tutorial will assume some familiarity with FEBioStudio already. If you are completely new to the software, it is advised to start with the introductory tutorials available on the FEBio Knowledgebase. </p>"},{"location":"febiochem_tutorial1/#model-setup","title":"Model Setup","text":""},{"location":"febiochem_tutorial1/#starting-a-new-model","title":"Starting a new model","text":"<p>Create a new model using the menu File \u2192 New Model.... From the dialog box that appears, select the reaction-diffusion option. Then click OK. </p>"},{"location":"febiochem_tutorial1/#creating-geometry-and-mesh","title":"Creating geometry and mesh","text":"<p>Select the Create tab on the Build panel and click the Box item. For the parameters, choose,</p> <ul> <li><code>Width</code> : 10</li> <li><code>Height</code> : 1</li> <li><code>Depth</code> : 1</li> </ul> <p>Then click the Create button. This will create a box of the specified dimensions. The box should appear on the screen. </p> <p></p> <p>Next, click the Mesh tab on the Build panel. Set the following parameters.</p> <ul> <li><code>Nx</code> : 100</li> <li><code>Ny</code> : 1</li> <li><code>Nz</code> : 1</li> </ul> <p>Leave all other parameters at their default values. Next, click Apply. </p> <p></p> <p>Note</p> <p>Note that we want to solve a 1D problem in this tutorial, but FEBio doesn't support true 1D analyses. FEBio only supports 3D analyses, which is why we create this 3D box. By using unit dimensions in \\(y\\) and \\(z\\) and using only single elements along \\(x\\) we'll be able to emulate a 1D analysis. </p>"},{"location":"febiochem_tutorial1/#creating-the-material","title":"Creating the material","text":"<p>First, we need to define the two species. Use the menu Physics \u2192 Solute Table to open the Solute Table dialog box. (FEBio usually refers to solutes instead of species, but in this case the distinction is not relevant). In this dialog box, click the Add button to a new species. Double-click the item under Name to edit the name. Change it to A. Do the same thing to create species B. </p> <p>Next, use the menu Physics \u2192 New Material... to open the Material dialog box. Select the reaction-diffusion option and click OK. A new (empty) material will appear in the model tree. </p> <p>Select the value of the <code>species</code> property and change it to 2. Two new entries appear under the species property. Select the value of the first species entry, and from the drop-down menu select the <code>&lt;select&gt;</code> option. From the dialog box that appears, choose Species. New parameters will appear under the species-1 item in the model tree. Set the following parameters:</p> <ul> <li><code>name</code>: select A from the dropdown box</li> <li><code>diffusivity</code> : 1</li> </ul> <p>Repeat the process for the species-2, but this time choose B for the species name. </p> <p>Next, we'll add the reaction. Select the value of the <code>reaction</code> property and set it to 1. This adds one reaction to the material. </p> <p>Then, select the value of reaction-1 and choose <code>&lt;select&gt;</code> from the dropdown. In the dialog box that appears, choose Mass Action. Click OK. </p> <p>This creates a reaction that follows the law of Mass Action. This reaction requires the following parameters:</p> <ul> <li><code>rate_constant</code> : 1</li> <li><code>equation</code> : <code>\"A--&gt;B\"</code></li> </ul> <p>This completes the definition of the material. </p> <p></p> <p>Finally, we need to assign this material to the box. First select the box by clicking on it in the Graphics View. A white bounding box should appear around the box to indicate that it is selected. To assign the material to the box, click the green plus button in the Selection pane of the Model panel, below the properties list. If the assignment was successful, the box will be colored with the same color that is assigned of the material.</p>"},{"location":"febiochem_tutorial1/#boundary-conditions","title":"Boundary Conditions","text":"<p>We'll apply only one boundary condition, namely an initial concentration flux for species A. Use the menu  Physics \u2192 Add Surface Load... to open the Add Surface Load dialog box. Select the concentration flux option and click OK. Set the following parameters:</p> <ul> <li><code>flux</code> : -1</li> <li><code>solute_id</code> : 1 (A has solute ID 1 since we created it first. B would have ID 2)</li> </ul> <p>To assign this load to the left face of the box, proceed as follows:</p> <ol> <li>Click the face selection button on the main toolbar above the Graphics View. (looks like a blue surface)</li> <li>Click the left face of the box. This is the face perpendicular to the \\(-x\\) axis. (Should be Surface4.)</li> <li>Click the green plus button on the Selection panel under the Model tree. (or use Ctrl+a shortcut). </li> </ol> <p>The load will now be applied to the left side of the box. </p>"},{"location":"febiochem_tutorial1/#analysis-and-solver-settings","title":"Analysis and solver settings","text":"<p>To complete the model setup, use the menu Physics \u2192 Add Analysis Step to open the Add Analysis dialog box. Just click OK on this dialog box and a new step will be added to the model. </p> <p>There are quite a few settings, but for this tutorial, we only need to change a few: </p> <ul> <li><code>analysis</code> : <code>TRANSIENT</code></li> <li><code>time_steps</code> : 100</li> <li><code>Auto time stepper</code> : (none) (To remove it click the <code>default</code> value, and select remove from the dropdown list.)</li> </ul> <p>Note</p> <p>The auto-time stepper adjusts the time step size automatically depending on how well the model is running. For this simple model it isn't necessary, and removing it simplifies the process of changing time steps or time step sizes.  </p>"},{"location":"febiochem_tutorial1/#output-settings","title":"Output settings","text":"<p>We need to decide what we want FEBio to output for our simulation. Right-click on plotfile item under the Output item in the model tree and select Edit output from the popup menu. In the dialog box that appears, check the actual concentration and concentraction flux variables. Then click Save.</p> <p>This completes the model setup and we are now ready to run the model. </p> <p>Tip</p> <p>This is also a good time to save the model if you haven't done so yet. </p>"},{"location":"febiochem_tutorial1/#running-the-tutorial","title":"Running the tutorial","text":"<p>FEBioChem models can be run in the same way as any other FEBio model. Click the Run button from the main toolbar, or choose the menu FEBio \u2192 Run FEBio.</p> <p>Make sure to save the model first before you run it. </p> <p>The default settings should be fine, but make sure to double-check the working directory. </p> <p>Then, click the Run button. </p> <p>If all goes well, the model should finish in a few seconds and the Job Summary dialog box appears. Click the button Open Results to view the results in FEBio Studio.</p>"},{"location":"febiochem_tutorial1/#visualizing-the-results","title":"Visualizing the results","text":"<p>There are many things to look at, but let's simply visualize the concentrations for the two species. First, select the <code>actual concentration (A)</code> variable from the dropdown list in the main toolbar. This plots the concentration of species A. You can then press the play button or drag the current time step displayed on the Timeline panel to view an animation of how the concentration changes over time. Note that it stabilizes after a short time and reaches its max value of 0.952 on the inlet side. The equilibrium is established once the rate of consumption of A (due to the reaction) balances the concentration influx. </p> <p>Now plot the <code>actual concentration (B)</code>, which displays the concentration of species B. Note that it continues to grow over time and does not stabilize. This is of course to be expected because there are no outflow conditions defined on species B. </p> <p></p>"},{"location":"febiochem_user_manual/","title":"User Manual","text":""},{"location":"febiochem_user_manual/#using-the-febiochem-plugin","title":"Using the FEBioChem plugin","text":"<p>Like any other FEBio plugin, the plugin must be placed in a folder and the path to the plugin must be defined in the FEBio configuration file. This file is usually called <code>febio.xml</code> and can be found in the same location as the FEBio executable. In this file, add the following line:</p> <pre><code>&lt;import&gt;C:\\path\\to\\febio\\plugin\\FEBioChem.dll&lt;/import&gt;\n</code></pre> <p>Make sure to include the full path name and file name of the plugin. When FEBio starts it will read the configuration file and load all the plugins defined therein. A message will be shown to the screen to inform the user whether the plugin was loaded successfully or not.</p>"},{"location":"febiochem_user_manual/#defining-an-febiochem-model","title":"Defining an FEBioChem model","text":"<p>For the most part an FEBioChem model is a standard FEBio model with a few modifications. These are discussed in the following sections. Note that this user\u2019s manual assumes version 4.0 of the FEBio file format.</p>"},{"location":"febiochem_user_manual/#module","title":"Module","text":"<p>The <code>type</code> attribute of <code>Module</code> tag needs the value <code>reaction-diffusion</code>.</p> <pre><code>&lt;Module type=\"reaction-diffusion\"/&gt;\n</code></pre> <p>This will inform FEBio to load the reaction-diffusion solver that is part of the FEBioChem plugin.</p> <p>This module does not include convection. If you want to include the convection term, you need to use the <code>reaction-diffusion-convection</code> module.</p> <pre><code>&lt;Module type=\"reaction-diffusion-convection\"/&gt;\n</code></pre> <p>Now, a velocity field variable is added to the model, which can be defined in the <code>Initial</code> section of the input file. See section initial velocity for more information on how to initialize the velocity field.</p>"},{"location":"febiochem_user_manual/#globals","title":"Globals","text":"<p>The chemical species that are used in the model are defined in the <code>Globals</code> section. The species are defined identically to the way they are defined for a multiphasic problem and we refer to the FEBio user\u2019s manual. The following caveat applies:</p> <ul> <li>A solute defines a chemical species that is not bound to the solid phase of a mixture. If a model doesn\u2019t represent a mixture, each solute defines a chemical species. No child properties need to be defined for a solute.</li> <li>A solid_bound defines a chemical species that is bound to the solid-phase of a mixture. Again, no child properties need to be defined for a solid bound species.</li> </ul>"},{"location":"febiochem_user_manual/#solver","title":"Solver","text":"<p>Make sure to set the solver type to the same name as the module. For instance, for a reaction-diffusion model, set</p> <pre><code>&lt;solver type=\"reaction-diffusion\"&gt;\n...\n&lt;/solver&gt;\n</code></pre>"},{"location":"febiochem_user_manual/#material","title":"Material","text":"<p>The material type needed by this plugin is <code>reaction-diffusion</code>. It needs the following material properties. Note that not all are required.</p> Property Description <code>solid_volume_fraction</code> The volume fraction of the solid phase <code>species</code> Specifies the properties of a chemical species <code>solid_bound_species</code> Specifies a species that remains bound to the solid phase of the mixture. <code>reaction</code> Specifies the chemical reaction. <p>The <code>solid_volume_fraction</code> is only required when modeling a mixture. It has an initial value of zero.</p>"},{"location":"febiochem_user_manual/#species-property","title":"species property","text":"<p>Each chemical species that is used by the material must be defined in the material\u2019s definition. (Note that this can be less than the total number of species in the model, as defined by the <code>Globals</code> section.). A particular species is referenced by name. For each species, the <code>diffusivity</code> parameter must be defined.</p> <pre><code>&lt;species name=\"A\"&gt;\n    &lt;diffusivity&gt;0.05&lt;/diffusivity&gt;\n&lt;/species&gt;\n</code></pre>"},{"location":"febiochem_user_manual/#solid_bound_species-property","title":"solid_bound_species property","text":"<p>Each solid-bound chemical species that is used by the material must be included in the material\u2019s definition. (Note that this can be less than the total number of species in the model, as defined by the <code>Globals</code> section). For each solid-bound species, define the following material parameters.</p> Parameter Description Default <code>rho0</code> Initial apparent density (w.r.t. the mixture volume) 0 <code>density</code> The true density of the solid-bound species 0 <code>rhomin</code> The minimum value of the apparent density allowed 0 <code>rhomax</code> The maximum value of the apparent density allowed (ignored) <code>molar_mass</code> The molar mass of the solid-bound species. 0"},{"location":"febiochem_user_manual/#reaction-property","title":"reaction property","text":"<p>The <code>reaction</code> property allows you to define a chemical reaction. Note that currently FEBioChem only models forward reactions. To model a reversible reaction you must specify two reactions, where the first reaction defines the forward reaction and the second defines the reverse reaction. Defining a reaction in the FEBioChem plugin is very easy since only two parameters need to be specified.</p> <p>The reaction equation is defined by writing the reaction formula as follows.</p> <ul> <li>Use the name of the species as defined in the Globals section to reference it.</li> <li>A stoichiometric coefficient of 1 does not need to be defined, but otherwise it must an integer number that appears before the species\u2019 name and separated from it via a multiplication symbol <code>*</code>. </li> <li>A plus symbol <code>+</code> is used to enumerate all reactants and products.</li> <li>The symbols <code>--&gt;</code> or <code>-&gt;</code> can be used to separate the reactants from the products. </li> <li>The reactant or product lists can be empty. </li> </ul> <p>Here are some examples. Assume that all the chemical species are properly defined in the <code>Globals</code> section. </p> <pre><code>A--&gt;B\nA+B--&gt;C\n2*A+2*B-&gt;C+B\nA--&gt;\n--&gt;B\n</code></pre> <p>Again, it is emphasized that all species involved in a reaction must be defined inside the material\u2019s definition.</p>"},{"location":"febiochem_user_manual/#initial-values","title":"Initial values","text":"<p>For each species (but not solid-bound species), an initial value can be set in the <code>Initial</code> section of the FEBio input file via the <code>init</code> tag.</p> <pre><code>&lt;ic type=\"initial concentration\" node_set=\"set1\"&gt;\n    &lt;dof&gt;c1&lt;/dof&gt;\n    &lt;value&gt;1.0&lt;/value&gt;\n&lt;/init&gt;\n</code></pre> <p>The <code>dof</code> parameter references the particular species (or solute). In this case, <code>c1</code> references the solute with ID equal to 1. The <code>node_set</code> references a node set that needs to be defined in the <code>Mesh</code> section of the input file.</p>"},{"location":"febiochem_user_manual/#boundary-conditions","title":"Boundary conditions","text":"<p>The syntax for defining fixed or prescribed is identical for any FEBio model. Use <code>c[n]</code> to reference a particular species (or solute, again no solid-bound species). Thus, for example, <code>c1</code> references solute with ID one, <code>c2</code> is the solute with ID 2, and so forth.  An example of a fixed boundary condition looks like this.</p> <p><pre><code>&lt;bc type=\"zero concentration\" node_set=\"FixedSet1\"&gt;\n    &lt;dof&gt;c1&lt;/dof&gt;\n&lt;/bc&gt;\n</code></pre> An example of a prescribed boundary condition looks like this.</p> <pre><code>&lt;bc type=\"prescribed concentration\" node_set=\"PrescribedSet1\"&gt;\n    &lt;dof&gt;c1&lt;/dof&gt;\n    &lt;value lc=\"1\"&gt;1.0&lt;/value&gt;\n&lt;/prescribe&gt;\n</code></pre> <p>The <code>node_set</code> attribute references nodesets that need to be defined in the <code>Mesh</code> section of the input file.</p>"},{"location":"febiochem_user_manual/#prescribing-a-concentration-flux","title":"Prescribing a concentration flux","text":"<p>A concentration flux can be prescribed via a surface load of type concentration flux and is defined as follows.</p> <pre><code>&lt;surface_load type=\"concentration flux\" surface=\"SurfaceLoad1\"&gt;\n    &lt;solute_id&gt;1&lt;/solute_id&gt;\n    &lt;flux lc=\"1\"&gt;-1.0&lt;/flux&gt;\n&lt;/surface_load&gt;\n</code></pre> <p>The <code>surface</code> attribute references a surface that is defined in the <code>Mesh</code> section. The <code>solute_id</code> references the ID of the corresponding solute as defined in the <code>Globals</code> section of the input file.</p>"},{"location":"febiochem_user_manual/#plot-variables","title":"Plot Variables","text":"<p>The FEBioChem plugin defines several new plot variables. They are list in the table below.</p> Plot variable Description <code>concentration</code> / <code>actual concentration</code> Get the true concentration of a species <code>effective concentration</code> Get the effective concentration of a species <code>sbs concentration</code> The true concentration of a solid-bound species <code>sbs apparent density</code> The apparent density of a solid-bound species <code>solid volume fraction</code> The solid volume fraction of the mixture <p>Note that the variables that references a species or a solid-bound species need to specify the name of the corresponding species as part of the plot variable definition. For instance,</p> <p><pre><code>&lt;var type=\"concentration['c1']\"/&gt;\n</code></pre> As with any other plot variable definition in FEBio, you can define an alias.</p> <pre><code>&lt;var type=\"concentration['c1']=c1/&gt;\n</code></pre> <p>The alias is the name of the data field that will be stored in the plot file, and thus will be show in FEBioStudio.</p>"},{"location":"febiochem_user_manual/#initial-velocity","title":"Initial velocity","text":"<p>For reaction-diffusion-convection problems, the fluid velocity needs to be initialized. This is done in the <code>Initial</code> section of the FEBio input file.</p> <p>The following example sets the x-component of the velocity vector to 1.0.</p> <pre><code>&lt;ic type=\"initial velocity\" node_set=\"SomeNodeSet\"&gt;\n    &lt;dof&gt;vx&lt;/dof&gt;\n    &lt;value&gt;1.0&lt;/value&gt;\n&lt;/init&gt;\n</code></pre> <p>You can also define a heterogeneous field. For instance,</p> <p><pre><code>&lt;ic type=\"initial velocity\" node_set=\"SomeNodeSet\"&gt;\n    &lt;dof&gt;vx&lt;/dof&gt;\n    &lt;value type=\"map\"&gt;init_vel&lt;value/&gt;\n&lt;/init&gt;\n</code></pre> Here, <code>init_vel</code> is a node data field that is defined in the <code>MeshData</code> section.</p> <p>You can also use a mathematical expression to set the initial velocity field. </p> <pre><code>&lt;ic type=\"initial velocity\" node_set=\"SomeNodeSet\"&gt;\n    &lt;dof&gt;vx&lt;/dof&gt;\n    &lt;value type=\"math\"&gt;4*(0.5 - Y)*(Y + 0.5)&lt;value/&gt;\n&lt;/init&gt;\n</code></pre>"}]}